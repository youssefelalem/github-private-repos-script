#!/bin/bash

# ============================================
# ุณูุฑูุจุช ูุชุญููู ุฌููุน ุงููุณุชูุฏุนุงุช ุงูุนุงูุฉ ุฅูู ุฎุงุตุฉ
# ============================================
#
# ูุฐุง ุงูุณูุฑูุจุช ูููู ุจุฌูุจ ูู ุงููุณุชูุฏุนุงุช ุงูุนุงูุฉ (public)
# ูู ุญุณุงุจ GitHub ุงูุฎุงุต ุจูุ ุซู ูููู ุจุชุญููููุง ุฅูู ุฎุงุตุฉ (private).
#
# ูุชุทูุจุงุช ุงูุชุดุบูู:
#  - GitHub CLI (gh) ูุซุจุชุฉ ุนูู ุฌูุงุฒู
#  - jq ูุซุจุชุฉ ุนูู ุฌูุงุฒู (ุฃุฏุงุฉ ููุนุงูุฌุฉ JSON)
#  - ุชุณุฌูู ุงูุฏุฎูู ุนุจุฑ ุงูุฃูุฑ: gh auth login
#
# ุทุฑููุฉ ุงูุงุณุชุนูุงู:
# 1. ุงูุชุญ Terminal ุฃู Git Bash.
# 2. ููุฐ 'gh auth login' ูุณุฌู ุฏุฎููู.
# 3. ููุฐ ูุฐุง ุงูุณูุฑูุจุช: bash make-private.sh
#
# ููุงุญุธุฉ:
#  - ุงูุณูุฑูุจุช ูุง ููุณุญ ุฃู ุดูุกุ ููุท ูุบูุฑ ุฅุนุฏุงุฏุงุช ุงูุฑุคูุฉ (visibility).
#  - ุชุฃูุฏ ูู ุฃูู ุชุฑูุฏ ุชุญููู ูู ุงูุฑูุจู public ุฅูู private.
#
# ============================================

USERNAME="youssefelalem"  # ุบููุฑ ูุฐุง ูู ุญุณุงุจู ูุฎุชูู

echo "๐ ุฌูุจ ูุงุฆูุฉ ุงููุณุชูุฏุนุงุช ุงูุนุงูุฉ..."

# ุงุณุชุฎุฑุงุฌ ุฃุณูุงุก ุงููุณุชูุฏุนุงุช ุงูุนุงูุฉุ ุชูุธูู ุงูุฃุณุทุฑ ูู ุฑููุฒ CR (\r)ุ ุซู ุงูุชูุฑุงุฑ ุนูู ูู ูุณุชูุฏุน
gh repo list "$USERNAME" --limit 1000 --json name,visibility | jq -r '.[] | select(.visibility=="PUBLIC") | .name' | tr -d '\r' | while IFS= read -r repo; do
    echo "โณ ุฌุงุฑู ุชุญููู ุงููุณุชูุฏุน \"$repo\" ุฅูู ุฎุงุต..."
    gh repo edit "$USERNAME/$repo" --visibility private --accept-visibility-change-consequences
    echo "โ ุชู ุชุญููู ุงููุณุชูุฏุน \"$repo\""
done

echo "๐ ุงูุชูู ุงูุณูุฑูุจุชุ ุชู ุชุญููู ุฌููุน ุงููุณุชูุฏุนุงุช ุงูุนุงูุฉ ุฅูู ุฎุงุตุฉ."
